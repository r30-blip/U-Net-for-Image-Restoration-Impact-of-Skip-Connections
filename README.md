%%U-Net を用いた劣化画像復元
%%概要

本プロジェクトでは、U-Net アーキテクチャを用いた劣化画像復元を目的とし、
CIFAR-10（32×32 カラー画像）に対して人工的に強い劣化処理を施したデータセットを用いて実験を行った。

Encoder–Decoder 構造に skip connection を導入した U-Net と、
skip connection を持たない Enc–Dec モデルを比較し、
復元性能および構造的な違いが結果に与える影響を検証した。

%%データセットと劣化処理

元データ：CIFAR-10（32×32 RGB 画像）

劣化処理は以下を複合的に適用

ガウシアンブラーによる高周波成分の除去

ダウンサンプリング（32×32 → 16×16）後のアップサンプリング

ガウスノイズの付加

これにより、輪郭情報・局所構造・画素値の一貫性が大きく失われた画像を生成し、
復元難易度の高い条件を設定した。

%%モデル構成
1. Enc–Dec（no-skip）モデル

畳み込み + MaxPooling による Encoder

転置畳み込みによる Decoder

特徴量は Encoder 内で段階的に圧縮され、Decoder 側には直接渡されない

→ 高解像度の局所情報が復元時に失われやすい構造

2. U-Net（skip connection あり）

上記 Enc–Dec 構造を拡張

各解像度（32×32 / 16×16 / 8×8）において
Encoder の特徴マップを Decoder に チャネル方向で結合

浅い層が保持する高解像度・局所的特徴を再利用可能

→ 輪郭・形状情報を保った復元が可能

%%学習条件

最適化手法：Adam

最大エポック数：10

ミニバッチサイズ：32

初期学習率：1.0 × 10⁻³

学習率減衰：5 エポックごとに 0.5 倍

評価指標：

RMSE（Root Mean Squared Error）

決定係数 R²

%%実験結果（定量評価）
モデル	RMSE (train)	RMSE (test)	R² (train)	R² (test)
Enc–Dec (no-skip)	  0.0868	    0.0871	    0.7940	0.7926
U-Net	              0.0750	    0.0752	    0.8463	0.8451

U-Net モデルは、no-skip モデルと比較して
RMSE の低下・R² の向上の両方を達成している。

%%考察

強い複合劣化が施された画像では、
Encoder 内で圧縮された際に 輪郭や局所構造の情報が失われやすい。

no-skip モデルでは、この情報損失を Decoder で十分に補えず、
全体的にぼやけた復元結果となった。

一方、U-Net では skip connection を通じて
Encoder の浅い層が保持する 高解像度かつ局所的な特徴を Decoder に直接伝達できるため、
輪郭や形状が明瞭な復元結果が得られた。

このことから、
強い劣化を伴う画像復元問題において U-Net 構造は有効であることが確認された。

本プロジェクトで得られた知見

skip connection は画像復元において重要な役割を果たす

定量評価（RMSE / R²）と視覚的評価は一致する傾向を示す

U-Net は低解像度画像に対しても有効に機能する

想定用途

画像復元・超解像の基礎検証

U-Net / Encoder–Decoder 構造の比較学習

深層学習における skip connection の効果理解
